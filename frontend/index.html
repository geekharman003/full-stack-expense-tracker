<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Full stack expense tracker</title>
    <link rel="stylesheet" href="styles.css" />
    <script src="https://sdk.cashfree.com/js/v3/cashfree.js"></script>
  </head>
  <body>
    <header>
      <nav>
        <ul id="navigation-list">
          <li><a href="#">Home</a></li>
          <!-- <li><a href="about.html">About</a></li> -->
          <li id="buy-premium-link"><a href="buy-premium.html">Buy Premium</a></li>
        </ul>
        <div id="logout-container">
          <button type="button" id="logout-btn" onclick="logout()">
            Logout
            <img
              width="15"
              height="15"
              style="color: white"
              src="images/icons/logout-svgrepo-com.svg"
              alt="logout"
            />
          </button>
        </div>
      </nav>
    </header>
    <div id="home-main" class="main">
      <!-- <button style="margin-left: 60%" id="pay-btn">Buy Premium</button> -->
      <div id="expense-form-container">
        <form id="expense-form" onsubmit="handleExpenseForm(event)">
          <label for="amount">Choose Expense Amount:</label>
          <br />
          <input type="number" id="amount" name="amount" min="10" required />
          <br />
          <br />
          <label for="description">Choose Description:</label>
          <br />
          <textarea
            name="description"
            id="description"
            rows="5"
            cols="30"
            required
          ></textarea>
          <br /><br />
          <label for="category">Choose Category:</label>
          <select name="category" id="category">
            <option value="food">food</option>
            <option value="electricity">electricity</option>
            <option value="bills">bills</option>
          </select>
          <br />
          <br />
          <button type="submit">Add Expense</button>
        </form>

        <div id="leaderboard-section" style="position: relative">
          <p id="premium-user-message"></p>
          <h3 style="margin-bottom: 5px">Leaderboard</h3>
          <!-- <button id="leaderboard-btn" onclick="showLeaderBoard()">
            Show Leaderboard
          </button> -->
          <ul id="leaderboard-list"></ul>
          <img
            width="60"
            height="60"
            style="position: absolute; top: -40px; rotate: 40deg; left: 90%"
            src="images/icons/crown-svgrepo-com.svg"
            alt=""
          />
        </div>
      </div>
      <br />
      <div id="expenses-section">
        <h2>Added Expenses</h2>
        <ul id="expense-list"></ul>
        <table id="expense-table">
          <thead>
            <tr id="expense-headings">
              <th>Amount</th>
              <th>Description</th>
              <th>Category</th>
              <th></th>
            </tr>
          </thead>
          <tbody id="table-body"></tbody>
        </table>
        <div id="paginated-btns-container">
          <!-- <div>
            <label for="rows-per-page-selector">Rows Per Page</label>
            <select
              name="rowsperpageselector"
              id="rows-per-page-selector"
              onchange="changeRowsPerPage(event)"
            >
              <option value="2">2</option>
              <option value="5">5</option>
              <option value="10">10</option>
            </select>
          </div> -->
          <div class="pagination"></div>
        </div>
        <button onclick="downloadExpenses(event)" id="download-expense-btn">
          <img
            id="download-img"
            width="20"
            src="images/icons/download-svgrepo-com.svg"
            alt=""
          />
          Download Expenses
        </button>
      </div>
      <div id="downloaded-expenses-table-container">
        <h3>List of Downloaded Expenses</h3>
        <table id="downloaded-expense-table">
          <tr>
            <th>Sr. No.</th>
            <th>URL</th>
          </tr>
        </table>
      </div>
    </div>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.11.0/axios.min.js"
      integrity="sha512-h9644v03pHqrIHThkvXhB2PJ8zf5E9IyVnrSfZg8Yj8k4RsO4zldcQc4Bi9iVLUCCsqNY0b4WXVV4UB+wbWENA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>

    <script>
      const token = localStorage.getItem("token");

      if (token) {
        axios
          .get("http://localhost:3000/", {
            headers: { authorization: token },
          })
          .then(() => {
            return;
          })
          .catch((err) => {
            console.log(err);
            window.location.href = "/frontend/login.html";
          });
      } else {
        window.location.href = "/frontend/login.html";
      }
    </script>
    <script>
      document.addEventListener("DOMContentLoaded", async () => {
        loadPage(1);
        fetchDownloadedExpenses();
        
        const token = localStorage.getItem("token");

        try {
          const res = await axios.get(
            "http://localhost:3000/premium/checkPremium",
            {
              headers: { Authorization: token },
            },
          );

          if (res.data.isPremium) {
            enablePremiumUserFeatures();
          }
        } catch (error) {
          console.log(error);
        }
      });
    </script>

    <script src="./script.js"></script>
  </body>
</html>
